{% extends "base.html" %}

{% block content %}
<body>
<div class="container">
    <input class="form-control" id="listSearch" type="text" placeholder="Search a Professor or Keyword...">
    <br>
</div>
<div>
    <section class="columns">
    <div class="container" style="height: 100%;">
        <div class="row">
            <div class="col-md-2" style="background-color:rgb(255, 255, 255)">
                <div class="panel panel-primary" id="filter_panel">
                    <div class="panel-heading">
                        <h3 class="panel-title">Filters</h3>
                    </div>
                        <button data-toggle="collapse" data-target="#filters">Course Filters</button>
                    <div class="panel-body" height="100%">
                        <div id="filters" class="collapse">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">
                                    COS
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">
                                    ORF
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">
                                    ECO
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-5 d-flex flex-column align-items-stretch flex-shrink-0">
                <div class="panel panel-primary" id="result_panel">
                    <div class="panel-heading">
                        <h3 class="panel-title">List of Professors</h3>
                    </div>
                    <div class="panel-body">
                        <div id="search-results" class="list-group list-group-flush border-bottom scrollarea flex-item-scroll" role="tablist">
                            
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-5">
                <div class="panel panel-primary" id="info_panel">
                    <div class="panel-heading">
                        <h3 class="panel-title">Information</h3>
                    </div>
                    <div id="display-info" class="panel-body tab-content scrollable" id="nav-tabContent">
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    </section>
</div>
</body>

<script> 
    $(document).ready(function() {
        $("#listSearch").on("input", function(e){
            search_text = $("#listSearch").val();
            $.ajax({
                method:"post",
                url:"/livesearch",
                data:{text: search_text},
                success:function(res) {
                    data = ""
                    data_box = ""

                    /* note the outer loop is the entire array (it only has one element); may fix this later */
                    /* this loop displays the search functions */
                    $.each(res, function(oindex, ovalue) {
                        $.each(ovalue, function(index, value){
                            data += 
                            "<a class=\"list-group-item list-group-item-action py-3 lh-tight\" id=\"list-prof" + value.id +"-list" +
                            "\" data-toggle=\"list\" href=\"#list-prof" + value.id + "\"" +
                            "role=\"tab\" aria-controls=\"prof" + value.id + "\">" +
                            " <div class=\"d-flex w-100 align-items-center justify-content-between\"> " + 
                            " <strong class=\"mb-1\">" + value.name + "</strong> " +
                            " <small>" + value.department + "</small> " +
                            " </div> " +
                            " <div class=\"col-10 mb-1 small\">" + value.keywords + "</div>" +
                            "</a>"

                            data_box += 
                            "<div class=\"tab-pane\" id=\"list-prof" + value.id + "\" role=\"tabpanel\" aria-labelledby=\"list-prof" + value.id + "-list\">" +
                            "<center> <h2> <span style=\"color:gray\">Professor</span> " + value.name + "</h2> </center>" +
                            "<div style=\"text-align: center\" class=\"h5 font-weight-300\">" + value.keywords + "</div>" +
                            "<table class=\"table table-hover table-sm table-properties\">" +
                                "<tr v-show=\"department\">" +
                                "    <th>Department: </th>" +
                                "    <td style=\"white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 20rem;\">" + value.department + "</td>" +
                                "</tr>" +
                                "<tr v-show=\"available\">" +
                                "    <th>Status: </th>" +
                                "    <td style=\"white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 20rem;\">Available for IW/Thesis Advising</td>" +
                                "</tr>" +
                                "<tr v-show=\"email\">" +
                                "    <th>Email</th>" +
                                "    <td>" + value.email + "</td>" +
                                "</tr>" +
                                "<tr v-show=\"website\">" +
                                "    <th>Website</th>" +
                                "    <td><a href=\"#" + value.website + "\">" + value.website + "</a></td>" +
                            "</tr>" +
                            "</table>" +
                            "<h5 class=\"mt-2\"><span class=\"fa fa-clock-o ion-clock float-right\"></span> Recent Publications</h5>" +
                            "<ul class=\"list-group\">" +
                            "    <li class=\"list-group-item\">Default 1</li>" +
                            "    <li class=\"list-group-item\">Default 2</li>" +
                            "    <li class=\"list-group-item\">Default 3</li>" +
                            "</ul>" +
                            "</div>"
                        });
                    });

                    $("#search-results").html(data)
                    $("#display-info").html(data_box)

                }
            })
        });
    })
</script>

{% endblock %}